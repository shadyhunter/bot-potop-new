<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Эксперты по затоплению — онлайн-консультация</title>
    <meta name="description" content="Эксперты по затоплению — быстрая консультация: что делать сейчас, как зафиксировать ущерб и подготовить документы." />

    <style>
      :root {
        --bg: #f8fafc; --ink: #0f172a; --ink-soft: #475569;
        --brand: #1e40af; --brand-2: #1d4ed8; --accent: #facc15;
        --card: #ffffff; --border: #e5e7eb;
      }
      * { box-sizing: border-box; }
      html, body { margin:0; padding:0; height:100%; background:var(--bg); color:var(--ink); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
      a { color: var(--brand-2); text-decoration: none; }
      header.top { background: #0b1220; color:#e2e8f0; padding:6px 0; font-size:12px; }
      .container { max-width: 1120px; margin: 0 auto; padding: 0 20px; }
      .brand { display:flex; align-items:center; gap:12px; padding:18px 0; }
      .brand h1 { margin:0; font-size:22px; font-weight:700; letter-spacing:.2px; }
      .brand small { color:var(--ink-soft); }
      .hero { position:relative; overflow:hidden; }
      .waves { position:absolute; inset:0; z-index:-1; }
      .grid { display:grid; gap:24px; grid-template-columns: 1fr; }
      @media (min-width: 980px) { .grid { grid-template-columns: 1.1fr .9fr; } }
      .badge { display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border:1px solid #c7d2fe; color:#1e3a8a; background:#eef2ff; border-radius:999px; font-size:12px; font-weight:600; }
      .h-title { margin:14px 0 10px; font-size:36px; line-height:1.1; }
      @media (min-width: 980px) { .h-title { font-size:48px; } }
      .lead { color:var(--ink-soft); font-size:16px; max-width: 56ch; }
      .checklist { display:grid; grid-template-columns: 1fr 1fr; gap:10px 16px; margin-top:16px; }
      .check { display:flex; align-items:center; gap:8px; font-size:14px; color:var(--ink-soft); }
      .check svg { width:18px; height:18px; color:#166534; }
      .card { background:var(--card); border:1px solid var(--border); border-radius:20px; box-shadow: 0 10px 24px rgba(2,6,23,.06); overflow:hidden; }
      .card .head { padding:12px 16px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; }
      .card .head .left { display:flex; align-items:center; gap:10px; }
      .emblem { width:28px; height:28px; }
      .card .body { height:640px; }
      footer { border-top:1px solid var(--border); margin-top:40px; padding:16px 0; font-size:12px; color:var(--ink-soft); }
      .cta { display:inline-block; margin-top:14px; background:var(--brand-2); color:white; padding:10px 14px; border-radius:12px; font-weight:700; }

      /* Наш чат-бокс */
      .chat { display:flex; flex-direction:column; height:100%; }
      .chat-messages { flex:1; overflow:auto; padding:12px; background:#fff; }
      .msg { margin-bottom:10px; }
      .msg.user { text-align:right; }
      .msg .bubble {
        display:inline-block; padding:10px 12px; border-radius:12px; max-width:85%;
        background:#eef2ff; color:#1e293b;
      }
      .msg.user .bubble { background:#1e40af; color:#fff; }
      .chat-input { display:flex; gap:8px; padding:10px; border-top:1px solid var(--border); background:#f9fafb; }
      .chat-input input {
        flex:1; padding:10px 12px; border:1px solid var(--border); border-radius:10px;
      }
      .chat-input button {
        padding:10px 14px; border:0; background:#1d4ed8; color:#fff; border-radius:10px; font-weight:600; cursor:pointer;
      }
      .typing { font-size:12px; color:#64748b; padding:0 12px 8px; }
    </style>
  </head>
  <body>
    <header class="top">
      <div class="container" style="display:flex;justify-content:space-between;">
        <div>Единая консультация при затоплениях</div>
        <div>Круглосуточно · По всей стране</div>
      </div>
    </header>

    <main class="container">
      <div class="brand">
        <!-- Эмблема со щитом и Фемидой (как у тебя) -->
        <svg class="emblem" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Эмблема">
          <defs>
            <linearGradient id="shield" x1="0" x2="0" y1="0" y2="1">
              <stop offset="0%" stop-color="#1e293b"/>
              <stop offset="100%" stop-color="#334155"/>
            </linearGradient>
            <linearGradient id="gold" x1="0" x2="1" y1="0" y2="1">
              <stop offset="0%" stop-color="#facc15"/>
              <stop offset="100%" stop-color="#eab308"/>
            </linearGradient>
          </defs>
          <path d="M100 10 L170 40 V110 C170 150 140 185 100 200 C60 185 30 150 30 110 V40 Z" fill="url(#shield)" stroke="#0f172a" stroke-width="6" />
          <g fill="none" stroke="url(#gold)" stroke-width="6" stroke-linecap="round">
            <path d="M30 100 C20 120, 25 145, 50 165"/>
            <path d="M170 100 C180 120, 175 145, 150 165"/>
          </g>
          <g transform="translate(100,95)">
            <rect x="-2" y="-55" width="4" height="60" fill="url(#gold)"/>
            <rect x="-8" y="-5" width="16" height="4" fill="url(#gold)"/>
            <circle cx="0" cy="-58" r="6" fill="url(#gold)"/>
            <line x1="0" y1="-5" x2="-38" y2="15" stroke="#facc15" stroke-width="5"/>
            <line x1="0" y1="-5" x2="38" y2="15" stroke="#facc15" stroke-width="5"/>
            <line x1="-38" y1="15" x2="-38" y2="35" stroke="#facc15" stroke-width="4"/>
            <line x1="38" y1="15" x2="38" y2="35" stroke="#facc15" stroke-width="4"/>
            <path d="M-58,35 Q-38,50 -18,35 Z" fill="#facc15"/>
            <path d="M18,35 Q38,50 58,35 Z" fill="#facc15"/>
          </g>
        </svg>
        <div>
          <h1>Эксперты по затоплению</h1>
          <small style="display:none">Официальный стиль · Доверительный сервис</small>
        </div>
      </div>

      <section class="hero">
        <svg class="waves" viewBox="0 0 1440 360" preserveAspectRatio="none" aria-hidden>
          <defs>
            <linearGradient id="g" x1="0" x2="0" y1="0" y2="1">
              <stop offset="0%" stop-color="#e0e7ff" />
              <stop offset="100%" stop-color="#ffffff" />
            </linearGradient>
          </defs>
          <rect width="1440" height="360" fill="url(#g)" />
          <path d="M0,140 C240,220 480,60 720,120 C960,180 1200,100 1440,140 L1440,360 L0,360 Z" fill="#e8edff" />
          <path d="M0,200 C240,280 480,120 720,180 C960,240 1200,160 1440,200 L1440,360 L0,360 Z" fill="#eef2ff" />
        </svg>

        <div class="grid">
          <div>
            <span class="badge">
              <svg width="8" height="8" viewBox="0 0 8 8" fill="#6366f1" aria-hidden><circle cx="4" cy="4" r="4"/></svg>
              Сценарии помощи · Шаг за шагом
            </span>
            <h2 class="h-title">
              Попали в <span style="color:#1e40af">потоп</span>?<br />Инструкции за 60 секунд
            </h2>
            <p class="lead">
              Получите план действий: безопасность, фото/видео-фиксация, звонки в УК, документы для компенсации и досудебный порядок.
            </p>

            <div class="checklist">
              <div class="check"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.2 4.8 12l1.4-1.4L9 13.4l8.8-8.8L19.2 6z"/></svg> Быстро</div>
              <div class="check"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.2 4.8 12l1.4-1.4L9 13.4l8.8-8.8L19.2 6z"/></svg> Бесплатно</div>
              <div class="check"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.2 4.8 12l1.4-1.4L9 13.4l8.8-8.8L19.2 6z"/></svg> 24/7</div>
            </div>

            <a class="cta" href="#chat">Открыть чат</a>
          </div>

          <div id="chat" class="card">
            <div class="head">
              <div class="left">
                <span style="font-weight:600">Окно консультации</span>
                <span style="color:#64748b;font-size:12px">Agent API</span>
              </div>
            </div>

            <div class="body">
              <div class="chat" id="chatRoot">
                <div id="messages" class="chat-messages"></div>
                <div id="typing" class="typing" style="display:none">Ассистент печатает…</div>
                <div class="chat-input">
                  <input id="input" type="text" placeholder="Опишите вашу ситуацию…" />
                  <button id="send">Отправить</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <div class="container" style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
        <div>Эксперты по затоплению</div>
        <div>© 2025 Информационный сервис. Не является экстренной службой.</div>
      </div>
    </footer>

    <noscript>Для работы чата включите JavaScript.</noscript>

    <script>
      const $msgs = document.getElementById('messages');
      const $typing = document.getElementById('typing');
      const $input = document.getElementById('input');
      const $send  = document.getElementById('send');

      function addMsg(role, text) {
        const wrap = document.createElement('div');
        wrap.className = 'msg ' + (role === 'user' ? 'user' : 'assistant');
        const bubble = document.createElement('div');
        bubble.className = 'bubble';
        bubble.textContent = text;
        wrap.appendChild(bubble);
        $msgs.appendChild(wrap);
        $msgs.scrollTop = $msgs.scrollHeight;
      }

      async function send() {
        const text = $input.value.trim();
        if (!text) return;
        addMsg('user', text);
        $input.value = '';
        $typing.style.display = 'block';
        try {
          const res = await fetch('/api/agent', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message: text })
          });
          const data = await res.json();
          if (!res.ok) throw new Error(data.error || 'Server error');
          addMsg('assistant', data.reply || '(пустой ответ)');
        } catch (e) {
          addMsg('assistant', 'Ошибка: ' + (e.message || e));
        } finally {
          $typing.style.display = 'none';
        }
      }

      $send.addEventListener('click', send);
      $input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') send();
      });
    </script>
  </body>
</html>
